"use strict";(self["webpackChunkhomework02"]=self["webpackChunkhomework02"]||[]).push([[522],{6522:function(e,t,l){l.r(t),l.d(t,{default:function(){return ye}});var s=l(3396),d=l(7139),a=l(9242);const r={class:"d-flex justify-content-between align-items-center"},o=(0,s._)("h1",{class:"my-3"},"訂單列表",-1),i=["disabled"],n={class:"table table-striped table-hover align-middle"},c=(0,s._)("thead",{class:"bg-dark text-white text-center"},[(0,s._)("tr",null,[(0,s._)("th",null,"編號"),(0,s._)("th",null,"購買時間"),(0,s._)("th",null,"客戶 Email"),(0,s._)("th",null,"購買項目"),(0,s._)("th",null,"購買數量／單位"),(0,s._)("th",null,"應付總金額"),(0,s._)("th",null,"是否已付款"),(0,s._)("th",null,"詳細內容")])],-1),u={class:"fw-bold text-center"},h={class:"text-center"},p={class:"text-center"},m={class:"text-center"},_={class:"list-group list-group-flush"},g={class:"text-end"},b={class:"list-group list-group-flush"},w={class:"text-end fw-bold pe-4"},f={class:"form-check form-switch"},y=["id","onUpdate:modelValue","onChange"],k=["for"],v=["for"],x={class:"text-center"},D={class:"btn-group btn-group-sm"},M=["onClick","disabled"],I=["onClick","disabled"],$={class:"py-5"};function O(e,t,l,O,z,C){const j=(0,s.up)("PaginationComp"),H=(0,s.up)("OrderModal"),N=(0,s.up)("DeleteModal");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",r,[o,(0,s._)("div",null,[(0,s._)("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=e=>this.$refs.deleteModal.openModal("全部訂單")),disabled:0===z.orders.length}," 刪除全部訂單 ",8,i)])]),(0,s._)("table",n,[c,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(z.orders,((e,t)=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",u,(0,d.zw)(t+1),1),(0,s._)("td",h,(0,d.zw)(new Date(1e3*e.create_at).toLocaleDateString()),1),(0,s._)("td",p,(0,d.zw)(e.user.email),1),(0,s._)("td",m,[(0,s._)("ul",_,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.products,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{class:"list-group-item bg-transparent border-0",key:t},(0,d.zw)(e.product.title),1)))),128))])]),(0,s._)("td",g,[(0,s._)("ul",b,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.products,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{class:"list-group-item bg-transparent border-0 pe-5",key:t},(0,d.zw)(e.qty)+" ／ "+(0,d.zw)(e.product.unit),1)))),128))])]),(0,s._)("td",w," NT$ "+(0,d.zw)(e.total),1),(0,s._)("td",null,[(0,s._)("div",f,[(0,s.wy)((0,s._)("input",{class:"form-check-input ms-4 me-2",type:"checkbox",id:e.id,"onUpdate:modelValue":t=>e.is_paid=t,onChange:t=>C.putOrder(e.id,e)},null,40,y),[[a.e8,e.is_paid]]),e.is_paid?((0,s.wg)(),(0,s.iD)("label",{key:0,class:"form-check-label text-success",for:e.id}," 已付款 ",8,k)):((0,s.wg)(),(0,s.iD)("label",{key:1,class:"form-check-label text-danger",for:e.id}," 未付款 ",8,v))])]),(0,s._)("td",x,[(0,s._)("div",D,[(0,s._)("button",{class:"btn btn-outline-primary",type:"button",onClick:t=>this.$refs.modal.openModal(e),disabled:z.selectedItemId===e.id}," 檢視 ",8,M),(0,s._)("button",{class:"btn btn-outline-danger",type:"button",onClick:t=>this.$refs.deleteModal.openModal(e),disabled:z.selectedItemId===e.id}," 刪除 ",8,I)])])])))),128))])]),(0,s._)("div",$,[(0,s.Wm)(j,{pagination:z.pagination,onGetRequest:C.getOrders},null,8,["pagination","onGetRequest"])]),(0,s.Wm)(H,{ref:"modal",onPutOrder:C.putOrder},null,8,["onPutOrder"]),(0,s.Wm)(N,{ref:"deleteModal",onDelItem:C.deleteOrder},null,8,["onDelItem"])],64)}const z=e=>((0,s.dD)("data-v-7d9192cc"),e=e(),(0,s.Cn)(),e),C={class:"modal fade",ref:"orderModal",tabindex:"-1"},j={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"},H={class:"modal-content border-0"},N=z((()=>(0,s._)("div",{class:"modal-header bg-primary"},[(0,s._)("h5",{class:"modal-title text-white"}," 訂單內容 "),(0,s._)("button",{type:"button",class:"btn-close bg-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),Y={class:"modal-body"},q={class:"row"},K=z((()=>(0,s._)("div",{class:"mt-4"},[(0,s._)("h3",null,"客戶資料")],-1))),P={class:"table table-striped table-hover align-middle"},S=z((()=>(0,s._)("td",null,"姓名",-1))),Z=z((()=>(0,s._)("td",null,"Email",-1))),T=z((()=>(0,s._)("td",null,"電話",-1))),U=z((()=>(0,s._)("td",null,"地址",-1))),V=z((()=>(0,s._)("div",{class:"mt-4"},[(0,s._)("h3",null,"訂單詳細內容")],-1))),W={class:"table table-striped table-hover align-middle"},A=z((()=>(0,s._)("td",null,"訂單編號",-1))),E=z((()=>(0,s._)("td",null,"購買時間",-1))),G=z((()=>(0,s._)("td",null,"付款狀態",-1))),J={class:"form-check form-switch"},L=["id"],R=["for"],B=["for"],F=z((()=>(0,s._)("td",null,"應付總金額",-1))),Q={class:"row mt-5"},X=z((()=>(0,s._)("h3",null,"選購商品",-1))),ee={class:"table table-striped table-hover align-middle text-end"},te=z((()=>(0,s._)("thead",{class:"bg-dark text-white"},[(0,s._)("tr",null,[(0,s._)("th",{class:"pe-5"},"商品名稱"),(0,s._)("th",{class:"pe-5"},"購買數量／單位"),(0,s._)("th",{class:"pe-5"},"金額")])],-1))),le={class:"pe-5"},se={class:"pe-5"},de={class:"list-group list-group-flush"},ae={class:"list-group-item bg-transparent border-0"},re={class:"pe-5"},oe={class:"modal-footer"},ie=z((()=>(0,s._)("button",{class:"btn btn-secondary",type:"button","data-bs-dismiss":"modal"}," 取消 ",-1)));function ne(e,t,l,r,o,i){return(0,s.wg)(),(0,s.iD)("div",C,[(0,s._)("div",j,[(0,s._)("div",H,[N,(0,s._)("div",Y,[(0,s._)("div",q,[K,(0,s._)("table",P,[(0,s._)("tbody",null,[(0,s._)("tr",null,[S,(0,s._)("td",null,(0,d.zw)(o.order.user.name),1)]),(0,s._)("tr",null,[Z,(0,s._)("td",null,(0,d.zw)(o.order.user.email),1)]),(0,s._)("tr",null,[T,(0,s._)("td",null,(0,d.zw)(o.order.user.tel),1)]),(0,s._)("tr",null,[U,(0,s._)("td",null,(0,d.zw)(o.order.user.address),1)])])]),V,(0,s._)("table",W,[(0,s._)("tbody",null,[(0,s._)("tr",null,[A,(0,s._)("td",null,(0,d.zw)(o.order.id),1)]),(0,s._)("tr",null,[E,(0,s._)("td",null,(0,d.zw)(new Date(1e3*o.order.create_at).toLocaleDateString()),1)]),(0,s._)("tr",null,[G,(0,s._)("td",null,[(0,s._)("div",J,[(0,s.wy)((0,s._)("input",{class:"form-check-input me-2",type:"checkbox",id:o.order.id,"onUpdate:modelValue":t[0]||(t[0]=e=>o.order.is_paid=e)},null,8,L),[[a.e8,o.order.is_paid]]),o.order.is_paid?((0,s.wg)(),(0,s.iD)("label",{key:0,class:"form-check-label text-success",for:o.order.id}," 已付款 ",8,R)):((0,s.wg)(),(0,s.iD)("label",{key:1,class:"form-check-label text-danger",for:o.order.id}," 未付款 ",8,B))])])]),(0,s._)("tr",null,[F,(0,s._)("td",null,"NT$ "+(0,d.zw)(o.order.total),1)])])])]),(0,s._)("div",Q,[X,(0,s._)("table",ee,[te,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.order.products,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",le,(0,d.zw)(e.product.title),1),(0,s._)("td",se,[(0,s._)("ul",de,[(0,s._)("li",ae,(0,d.zw)(e.qty)+" ／ "+(0,d.zw)(e.product.unit),1)])]),(0,s._)("td",re,"NT$ "+(0,d.zw)(e.total),1)])))),128))])])])]),(0,s._)("div",oe,[(0,s._)("button",{class:"btn btn-primary",type:"button",onClick:t[1]||(t[1]=t=>e.$emit("put-order",o.order.id,o.order))}," 修改付款狀態 "),ie])])])],512)}var ce=l(7972),ue=l.n(ce),he={data(){return{modal:{},order:{products:{},user:{}}}},methods:{openModal(e){this.order=JSON.parse(JSON.stringify(e)),this.modal.show()},closeModal(){this.modal.hide()}},mounted(){this.modal=new(ue())(this.$refs.orderModal,{backdrop:"static",keyboard:!1})}},pe=l(89);const me=(0,pe.Z)(he,[["render",ne],["__scopeId","data-v-7d9192cc"]]);var _e=me,ge=l(4174),be=l(7839),we={data(){return{orders:[],pagination:{},selectedItemId:"",loader:{}}},components:{OrderModal:_e,PaginationComp:ge.Z,DeleteModal:be.Z},inject:["emitter"],methods:{getOrders(e=1){this.loader=this.$loading.show();const t=`\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/orders/?page=${e}\n      `;this.$http.get(t).then((e=>{const{orders:t,pagination:l}=e.data;this.orders=t,this.pagination=l,this.loader.hide()})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"取得訂單",content:e.response.data.message}),this.loader.hide()}))},putOrder(e,t){this.selectedItemId=e;const l=`\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/order/${e}\n      `;this.$http.put(l,{data:t}).then((e=>{this.$refs.modal.closeModal(),this.getOrders(this.pagination.current_page),this.emitter.emit("push-message",{style:"primary",title:"更新訂單",content:e.data.message}),this.selectedItemId=""})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"更新訂單",content:e.response.data.message}),this.selectedItemId=""}))},deleteOrder(e){if("all"===e)this.deleteAllOrders();else{this.selectedItemId=e;const t=`\n          https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/order/${e}\n        `;this.$http.delete(t).then((()=>{this.getOrders(),this.emitter.emit("push-message",{style:"danger",title:"刪除訂單",content:"訂單刪除成功!"}),this.selectedItemId="",this.$refs.deleteModal.closeModal()})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"刪除訂單",content:e.response.data.message}),this.selectedItemId="",this.$refs.deleteModal.closeModal()}))}},deleteAllOrders(){const e="\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/orders/all\n      ";this.$http.delete(e).then((()=>{this.getOrders(),this.emitter.emit("push-message",{style:"danger",title:"刪除全部訂單",content:"全部訂單刪除成功!"}),this.$refs.deleteModal.closeModal()})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"刪除全部訂單",content:e.response.data.message}),this.$refs.deleteModal.closeModal()}))}},mounted(){this.getOrders()}};const fe=(0,pe.Z)(we,[["render",O]]);var ye=fe}}]);
//# sourceMappingURL=522.da0ed175.js.map