"use strict";(self["webpackChunkhomework02"]=self["webpackChunkhomework02"]||[]).push([[538],{9538:function(e,t,o){o.r(t),o.d(t,{default:function(){return se}});var s=o(3396),l=o(7139);const a={class:"d-flex justify-content-between align-items-center"},n=(0,s._)("h1",{class:"my-3"},"優惠券列表",-1),i={class:"table table-striped table-hover align-middle text-center"},d=(0,s._)("thead",{class:"bg-dark text-white"},[(0,s._)("tr",null,[(0,s._)("th",null,"編號"),(0,s._)("th",null,"優惠券名稱"),(0,s._)("th",null,"優惠折扣(%)"),(0,s._)("th",null,"使用期限"),(0,s._)("th",null,"是否啟用"),(0,s._)("th",null,"編輯內容")])],-1),c={class:"fw-bold"},u=(0,s._)("span",{class:"fw-bold"},"啟用狀態：",-1),p={key:0,class:"text-success fw-bold"},r={key:1,class:"text-muted"},h={class:"btn-group btn-group-sm"},m=["onClick","disabled"],b=["onClick","disabled"],_={class:"py-5"};function g(e,t,o,g,f,w){const y=(0,s.up)("PaginationComp"),v=(0,s.up)("CouponModal"),C=(0,s.up)("DeleteModal");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",a,[n,(0,s._)("div",null,[(0,s._)("button",{class:"btn btn-success",type:"button",onClick:t[0]||(t[0]=e=>this.$refs.modal.openModal(!0,{}))}," 新增優惠券 ")])]),(0,s._)("table",i,[d,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(f.coupons,((e,t)=>((0,s.wg)(),(0,s.iD)("tr",{key:"c"+t},[(0,s._)("td",c,(0,l.zw)(t+1),1),(0,s._)("td",null,(0,l.zw)(e.title),1),(0,s._)("td",null,(0,l.zw)(e.percent)+" %",1),(0,s._)("td",null,(0,l.zw)(new Date(1e3*e.due_date).toLocaleDateString()),1),(0,s._)("td",null,[u,e.is_enabled?((0,s.wg)(),(0,s.iD)("span",p," 已啟用 ")):((0,s.wg)(),(0,s.iD)("span",r," 未啟用 "))]),(0,s._)("td",null,[(0,s._)("div",h,[(0,s._)("button",{class:"btn btn-outline-primary",type:"button",onClick:t=>this.$refs.modal.openModal(!1,e),disabled:f.selectedItemId===e.id}," 修改 ",8,m),(0,s._)("button",{class:"btn btn-outline-danger",type:"button",onClick:t=>this.$refs.deleteModal.openModal(e),disabled:f.selectedItemId===e.id}," 刪除 ",8,b)])])])))),128))])]),(0,s._)("div",_,[(0,s.Wm)(y,{pagination:f.pagination,onGetRequest:w.getCoupons},null,8,["pagination","onGetRequest"])]),(0,s.Wm)(v,{ref:"modal",onPostCoupon:w.postCoupon,onPutCoupon:w.putCoupon},null,8,["onPostCoupon","onPutCoupon"]),(0,s.Wm)(C,{ref:"deleteModal",onDelItem:w.deleteCoupon},null,8,["onDelItem"])],64)}var f=o(9242);const w={class:"modal fade",ref:"couponModal",tabindex:"-1"},y={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},v={class:"modal-content border-0"},C={key:0},k=(0,s._)("div",{class:"modal-header bg-success"},[(0,s._)("h5",{class:"modal-title text-white"}," 新增優惠券 "),(0,s._)("button",{type:"button",class:"btn-close bg-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),M=[k],$={key:1},I=(0,s._)("div",{class:"modal-header bg-primary"},[(0,s._)("h5",{class:"modal-title text-white"}," 編輯優惠券 "),(0,s._)("button",{type:"button",class:"btn-close bg-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D=[I],x={class:"modal-body"},q={class:"mb-3"},j=(0,s._)("label",{class:"form-label",for:"coupon-title"},"優惠券名稱",-1),N={class:"mb-3"},P=(0,s._)("label",{class:"form-label",for:"coupon-code"},"優惠碼",-1),S={class:"mb-3"},U=(0,s._)("label",{class:"form-label",for:"coupon-due_date"},"使用期限",-1),V={class:"mb-3"},z=(0,s._)("label",{class:"form-label",for:"coupon-percent"},"優惠折扣（0%～100%）",-1),Z={class:"mb-3"},O={class:"form-check form-switch"},W=(0,s._)("span",{class:"fw-bold"},"啟用狀態：",-1),G={key:0,class:"form-check-label text-success fw-bold",for:"is_enabled"},H={key:1,class:"form-check-label text-muted",for:"is_enabled"},J={class:"modal-footer"},R={key:0},Y={key:1},K=(0,s._)("button",{class:"btn btn-secondary",type:"button","data-bs-dismiss":"modal"}," 取消 ",-1);function L(e,t,o,l,a,n){return(0,s.wg)(),(0,s.iD)("div",w,[(0,s._)("div",y,[(0,s._)("div",v,[a.isNewCoupon?((0,s.wg)(),(0,s.iD)("div",C,M)):((0,s.wg)(),(0,s.iD)("div",$,D)),(0,s._)("div",x,[(0,s._)("div",q,[j,(0,s.wy)((0,s._)("input",{class:"form-control",type:"text",id:"coupon-title","onUpdate:modelValue":t[0]||(t[0]=e=>a.coupon.title=e),placeholder:"請輸入優惠券名稱",required:""},null,512),[[f.nr,a.coupon.title]])]),(0,s._)("div",N,[P,(0,s.wy)((0,s._)("input",{class:"form-control",type:"text",id:"coupon-code","onUpdate:modelValue":t[1]||(t[1]=e=>a.coupon.code=e),placeholder:"請輸入優惠碼",required:""},null,512),[[f.nr,a.coupon.code]])]),(0,s._)("div",S,[U,(0,s.wy)((0,s._)("input",{class:"form-control",type:"date",id:"coupon-due_date","onUpdate:modelValue":t[2]||(t[2]=e=>a.due_date=e),required:""},null,512),[[f.nr,a.due_date]])]),(0,s._)("div",V,[z,(0,s.wy)((0,s._)("input",{class:"form-control",type:"number",id:"coupon-percent","onUpdate:modelValue":t[3]||(t[3]=e=>a.coupon.percent=e),placeholder:"請輸入優惠折扣",min:"0",max:"100",oninput:"this.value = !!this.value\n                && Math.abs(this.value) >= 0\n                && Math.abs(this.value) <= 100\n                ? Math.abs(this.value) : null",required:""},null,512),[[f.nr,a.coupon.percent,void 0,{number:!0}]])]),(0,s._)("div",Z,[(0,s._)("div",O,[W,(0,s.wy)((0,s._)("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","onUpdate:modelValue":t[4]||(t[4]=e=>a.coupon.is_enabled=e),"true-value":1,"false-value":0,required:""},null,512),[[f.e8,a.coupon.is_enabled]]),a.coupon.is_enabled?((0,s.wg)(),(0,s.iD)("label",G," 已啟用 ")):((0,s.wg)(),(0,s.iD)("label",H," 未啟用 "))])])]),(0,s._)("div",J,[a.isNewCoupon?((0,s.wg)(),(0,s.iD)("div",R,[(0,s._)("button",{class:"btn btn-success",type:"button",onClick:t[5]||(t[5]=t=>e.$emit("post-coupon",a.coupon))}," 確認新增 ")])):((0,s.wg)(),(0,s.iD)("div",Y,[(0,s._)("button",{class:"btn btn-primary",type:"button",onClick:t[6]||(t[6]=t=>e.$emit("put-coupon",a.coupon.id,a.coupon))}," 確認編輯 ")])),K])])])],512)}var T=o(7972),A=o.n(T),B={data(){return{modal:{},coupon:{},due_date:"",isNewCoupon:!1}},methods:{openModal(e,t){if(this.isNewCoupon=e,e)this.coupon={},this.due_date="";else{this.coupon=JSON.parse(JSON.stringify(t));const e=new Date(1e3*this.coupon.due_date).toISOString().split("T");[this.due_date]=e}this.modal.show()},closeModal(){this.modal.hide()}},watch:{due_date(){this.coupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},mounted(){this.modal=new(A())(this.$refs.couponModal,{backdrop:"static",keyboard:!1})}},E=o(89);const F=(0,E.Z)(B,[["render",L]]);var Q=F,X=o(4174),ee=o(7839),te={data(){return{coupons:[],pagination:{},selectedItemId:"",loader:{}}},components:{CouponModal:Q,PaginationComp:X.Z,DeleteModal:ee.Z},inject:["emitter"],methods:{getCoupons(e=1){this.loader=this.$loading.show();const t=`\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/coupons/?page=${e}\n      `;this.$http.get(t).then((e=>{const{coupons:t,pagination:o}=e.data;this.coupons=t,this.pagination=o,this.loader.hide()})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"取得優惠券",content:e.response.data.message}),this.loader.hide()}))},postCoupon(e){const t="\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/coupon\n      ";this.$http.post(t,{data:e}).then((t=>{this.$refs.modal.closeModal(),this.getCoupons(),this.emitter.emit("push-message",{style:"success",title:"新增優惠券",content:`${t.data.message}：${e.title}`})})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"新增優惠券",content:e.response.data.message})}))},putCoupon(e,t){this.selectedItemId=e;const o=`\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/coupon/${e}\n      `;this.$http.put(o,{data:t}).then((e=>{this.$refs.modal.closeModal(),this.getCoupons(),this.emitter.emit("push-message",{style:"primary",title:"更新優惠券",content:`${e.data.message}：${t.title}`}),this.selectedItemId=""})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"更新優惠券",content:e.response.data.message}),this.selectedItemId=""}))},deleteCoupon(e){this.selectedItemId=e;const t=`\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/coupon/${e}\n      `;this.$http.delete(t).then((e=>{this.getCoupons(),this.emitter.emit("push-message",{style:"danger",title:"刪除優惠券",content:e.data.message}),this.selectedItemId="",this.$refs.deleteModal.closeModal()})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"刪除優惠券",content:e.response.data.message}),this.selectedItemId="",this.$refs.deleteModal.closeModal()}))}},mounted(){this.getCoupons()}};const oe=(0,E.Z)(te,[["render",g]]);var se=oe}}]);
//# sourceMappingURL=538.a00dad48.js.map