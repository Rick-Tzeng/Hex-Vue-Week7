"use strict";(self["webpackChunkhomework02"]=self["webpackChunkhomework02"]||[]).push([[682],{3682:function(e,t,s){s.r(t),s.d(t,{default:function(){return He}});var l=s(3396),a=s(7139),o=s(9242);const i={class:"d-flex justify-content-between align-items-center"},d=(0,l._)("h1",{class:"my-3"},"產品列表",-1),r={class:"py-5"},c={class:"row row-cols-1 row-cols-md-3 row-cols-lg-4 row-cols-xl-5 g-5"},n={class:"card h-100"},u={class:"card-body"},p={class:"card-title fw-bold"},m={class:"card-text"},h={class:"form-check form-switch d-flex justify-content-end pe-3"},g=["id","onUpdate:modelValue","onChange","disabled"],b=["for"],_=["for"],f={class:"p-3"},v={key:0,class:"h4"},y={key:1,class:"text-end"},w={class:"text-muted"},k=(0,l.Uk)(" 現在只要"),U={class:"h4 text-danger px-1"},x={class:"card-footer d-flex"},I=["onClick","disabled"],P=["onClick","disabled"],$={class:"py-5"};function D(e,t,s,D,M,C){const V=(0,l.up)("PaginationComp"),q=(0,l.up)("ProductModal"),j=(0,l.up)("DeleteModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",i,[d,(0,l._)("button",{class:"btn btn-success",type:"button",onClick:t[0]||(t[0]=e=>this.$refs.modal.openModal(!0,{}))}," 新增產品 ")]),(0,l._)("div",r,[(0,l.Wm)(V,{pagination:M.pagination,onGetRequest:C.getProducts},null,8,["pagination","onGetRequest"])]),(0,l._)("div",c,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(M.products,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"col",key:e.id},[(0,l._)("div",n,[(0,l._)("div",{style:(0,a.j5)(`\n          height: 240px;\n          background-image: url(${e.imageUrl});\n          background-size: cover;\n          background-position: center 40%;\n          `)},null,4),(0,l._)("div",u,[(0,l._)("div",p,(0,a.zw)(e.title),1),(0,l._)("div",m,(0,a.zw)(e.description),1)]),(0,l._)("div",h,[(0,l.wy)((0,l._)("input",{class:"form-check-input me-1",type:"checkbox",id:e.id,"onUpdate:modelValue":t=>e.is_enabled=t,"true-value":1,"false-value":0,onChange:t=>C.putProduct(e.id,e),disabled:M.selectedItemId===e.id},null,40,g),[[o.e8,e.is_enabled]]),e.is_enabled?((0,l.wg)(),(0,l.iD)("label",{key:0,class:"form-check-label text-success fw-bold",for:e.id}," 已啟用 ",8,b)):((0,l.wg)(),(0,l.iD)("label",{key:1,class:"form-check-label text-muted",for:e.id}," 未啟用 ",8,_))]),(0,l._)("div",f,[e.price?((0,l.wg)(),(0,l.iD)("div",y,[(0,l._)("del",w," 原價 "+(0,a.zw)(e.origin_price)+" 元 / "+(0,a.zw)(e.unit),1),(0,l._)("div",null,[k,(0,l._)("span",U,(0,a.zw)(e.price),1),(0,l.Uk)(" 元 / "+(0,a.zw)(e.unit),1)])])):((0,l.wg)(),(0,l.iD)("div",v,(0,a.zw)(e.origin_price)+" 元 / "+(0,a.zw)(e.unit),1))]),(0,l._)("div",x,[(0,l._)("button",{class:"btn btn-primary",type:"button",onClick:t=>this.$refs.modal.openModal(!1,e),disabled:M.selectedItemId===e.id}," 編輯 ",8,I),(0,l._)("button",{class:"btn btn-danger ms-auto",type:"button",onClick:t=>this.$refs.deleteModal.openModal(e),disabled:M.selectedItemId===e.id}," 刪除 ",8,P)])])])))),128))]),(0,l._)("div",$,[(0,l.Wm)(V,{pagination:M.pagination,onGetRequest:C.getProducts},null,8,["pagination","onGetRequest"])]),(0,l.Wm)(q,{ref:"modal",onPostProduct:C.postProduct,onPutProduct:C.putProduct},null,8,["onPostProduct","onPutProduct"]),(0,l.Wm)(j,{ref:"deleteModal",onDelItem:C.deleteProduct},null,8,["onDelItem"])],64)}var M=s(4174);const C={class:"modal fade",ref:"productModal",tabindex:"-1"},V={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"},q={class:"modal-content border-0"},j={key:0},z=(0,l._)("div",{class:"modal-header bg-success"},[(0,l._)("h5",{class:"modal-title text-white"}," 新增產品 "),(0,l._)("button",{type:"button",class:"btn-close bg-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),S=[z],N={key:1},G=(0,l._)("div",{class:"modal-header bg-primary"},[(0,l._)("h5",{class:"modal-title text-white"}," 編輯產品 "),(0,l._)("button",{type:"button",class:"btn-close bg-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),R=[G],W={class:"modal-body"},Z={class:"row"},H={class:"col-sm-4"},Y={class:"mb-3"},A=(0,l._)("label",{class:"form-label",for:"imageUrl"},"主要圖片",-1),J=["src","alt"],K={class:"mb-3"},O=["disabled"],F=["disabled"],T=(0,l._)("h3",{class:"mb-3"},"新增更多圖片",-1),B={key:0},E={class:"mb-3"},L=(0,l._)("label",{class:"form-label",for:"imagesUrl"},"圖片網址",-1),Q=["onUpdate:modelValue"],X={key:0},ee=["src","alt"],te={key:0},se={key:1},le={key:1},ae={class:"col-sm-8"},oe={class:"mb-3"},ie={class:"form-check form-switch"},de=(0,l._)("span",{class:"fw-bold"},"啟用狀態：",-1),re={key:0,class:"form-check-label text-success fw-bold",for:"is_enabled"},ce={key:1,class:"form-check-label text-muted",for:"is_enabled"},ne={class:"mb-3"},ue=(0,l._)("label",{class:"form-label",for:"title"},"商品名稱",-1),pe={class:"row"},me={class:"mb-3 col-md-6"},he=(0,l._)("label",{class:"form-label",for:"category"},"分類",-1),ge={class:"mb-3 col-md-6"},be=(0,l._)("label",{class:"form-label",for:"unit"},"單位",-1),_e={class:"row"},fe={class:"mb-3 col-md-6"},ve=(0,l._)("label",{class:"form-label",for:"origin_price"},"原價",-1),ye={class:"mb-3 col-md-6"},we=(0,l._)("label",{class:"form-label",for:"price"},"售價",-1),ke=(0,l._)("hr",null,null,-1),Ue={class:"mb-3"},xe=(0,l._)("label",{class:"form-label",for:"description"},"產品描述",-1),Ie={class:"mb-3"},Pe=(0,l._)("label",{class:"form-label",for:"content"},"說明內容",-1),$e={class:"modal-footer"},De={key:0},Me={key:1},Ce=(0,l._)("button",{class:"btn btn-secondary",type:"button","data-bs-dismiss":"modal"}," 取消 ",-1);function Ve(e,t,s,a,i,d){return(0,l.wg)(),(0,l.iD)("div",C,[(0,l._)("div",V,[(0,l._)("div",q,[i.isNewProduct?((0,l.wg)(),(0,l.iD)("div",j,S)):((0,l.wg)(),(0,l.iD)("div",N,R)),(0,l._)("div",W,[(0,l._)("div",Z,[(0,l._)("div",H,[(0,l._)("div",Y,[A,(0,l.wy)((0,l._)("input",{class:"form-control",type:"text",id:"imageUrl","onUpdate:modelValue":t[0]||(t[0]=e=>i.product.imageUrl=e),placeholder:"請輸入圖片連結",required:""},null,512),[[o.nr,i.product.imageUrl]]),(0,l._)("img",{class:"img-fluid",src:i.product.imageUrl,alt:i.product.title},null,8,J)]),(0,l._)("div",K,[(0,l._)("label",{class:"form-label",for:"upload-ImageUrl",disabled:i.uploadStatus}," 或 上傳圖片 ",8,O),(0,l._)("input",{ref:"uploadInput",class:"form-control",type:"file",id:"upload-ImageUrl",onChange:t[1]||(t[1]=(...e)=>d.uploadImage&&d.uploadImage(...e)),disabled:i.uploadStatus},null,40,F)]),T,Array.isArray(i.product.imagesUrl)?((0,l.wg)(),(0,l.iD)("div",B,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.product.imagesUrl,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"mb-1",key:"img"+t},[(0,l._)("div",E,[L,(0,l.wy)((0,l._)("input",{class:"form-control",type:"text",id:"imagesUrl","onUpdate:modelValue":e=>i.product.imagesUrl[t]=e,placeholder:"請輸入圖片連結"},null,8,Q),[[o.nr,i.product.imagesUrl[t]]])]),i.product.imagesUrl[t]?((0,l.wg)(),(0,l.iD)("div",X,[(0,l._)("img",{class:"img-fluid",src:e,alt:i.product.title},null,8,ee)])):(0,l.kq)("",!0)])))),128)),!i.product.imagesUrl.length||i.product.imagesUrl[i.product.imagesUrl.length-1]?((0,l.wg)(),(0,l.iD)("div",te,[(0,l._)("button",{class:"btn btn-outline-primary",onClick:t[2]||(t[2]=e=>i.product.imagesUrl.push(""))}," 新增圖片 ")])):((0,l.wg)(),(0,l.iD)("div",se,[(0,l._)("button",{class:"btn btn-outline-danger",onClick:t[3]||(t[3]=e=>i.product.imagesUrl.pop(""))}," 刪除圖片 ")]))])):((0,l.wg)(),(0,l.iD)("div",le,[(0,l._)("button",{class:"btn btn-outline-primary",onClick:t[4]||(t[4]=(...e)=>d.createImages&&d.createImages(...e))}," 新增圖片 ")]))]),(0,l._)("div",ae,[(0,l._)("div",oe,[(0,l._)("div",ie,[de,(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","onUpdate:modelValue":t[5]||(t[5]=e=>i.product.is_enabled=e),"true-value":1,"false-value":0},null,512),[[o.e8,i.product.is_enabled]]),i.product.is_enabled?((0,l.wg)(),(0,l.iD)("label",re," 已啟用 ")):((0,l.wg)(),(0,l.iD)("label",ce," 未啟用 "))])]),(0,l._)("div",ne,[ue,(0,l.wy)((0,l._)("input",{class:"form-control",type:"text",id:"title","onUpdate:modelValue":t[6]||(t[6]=e=>i.product.title=e),placeholder:"請輸入商品名稱",required:""},null,512),[[o.nr,i.product.title]])]),(0,l._)("div",pe,[(0,l._)("div",me,[he,(0,l.wy)((0,l._)("input",{class:"form-control",type:"text",id:"category","onUpdate:modelValue":t[7]||(t[7]=e=>i.product.category=e),placeholder:"請輸入分類",required:""},null,512),[[o.nr,i.product.category]])]),(0,l._)("div",ge,[be,(0,l.wy)((0,l._)("input",{class:"form-control",type:"text",id:"unit","onUpdate:modelValue":t[8]||(t[8]=e=>i.product.unit=e),placeholder:"請輸入單位",required:""},null,512),[[o.nr,i.product.unit]])])]),(0,l._)("div",_e,[(0,l._)("div",fe,[ve,(0,l.wy)((0,l._)("input",{class:"form-control",type:"number",id:"origin_price","onUpdate:modelValue":t[9]||(t[9]=e=>i.product.origin_price=e),placeholder:"請輸入原價",min:"0",oninput:"this.value = !!this.value\n                      && Math.abs(this.value) >= 0\n                      ? Math.abs(this.value) : null",required:""},null,512),[[o.nr,i.product.origin_price,void 0,{number:!0}]])]),(0,l._)("div",ye,[we,(0,l.wy)((0,l._)("input",{class:"form-control",type:"number",id:"price","onUpdate:modelValue":t[10]||(t[10]=e=>i.product.price=e),placeholder:"請輸入售價",min:"0",oninput:"this.value = !!this.value\n                      && Math.abs(this.value) >= 0\n                      ? Math.abs(this.value) : null",required:""},null,512),[[o.nr,i.product.price,void 0,{number:!0}]])])]),ke,(0,l._)("div",Ue,[xe,(0,l.wy)((0,l._)("textarea",{class:"form-control",type:"text",id:"description","onUpdate:modelValue":t[11]||(t[11]=e=>i.product.description=e),placeholder:"請輸入產品描述"},null,512),[[o.nr,i.product.description]])]),(0,l._)("div",Ie,[Pe,(0,l.wy)((0,l._)("textarea",{class:"form-control",type:"text",id:"content","onUpdate:modelValue":t[12]||(t[12]=e=>i.product.content=e),placeholder:"請輸入產品內容"},null,512),[[o.nr,i.product.content]])])])])]),(0,l._)("div",$e,[i.isNewProduct?((0,l.wg)(),(0,l.iD)("div",De,[(0,l._)("button",{class:"btn btn-success",type:"button",onClick:t[13]||(t[13]=t=>e.$emit("post-product",i.product))}," 確認新增 ")])):((0,l.wg)(),(0,l.iD)("div",Me,[(0,l._)("button",{class:"btn btn-primary",type:"button",onClick:t[14]||(t[14]=t=>e.$emit("put-product",i.product.id,i.product))}," 確認編輯 ")])),Ce])])])],512)}var qe=s(7972),je=s.n(qe),ze={data(){return{modal:{},product:{},loader:{},isNewProduct:!1,uploadStatus:!1}},inject:["emitter"],methods:{openModal(e,t){this.isNewProduct=e,this.product=e?{imagesUrl:[]}:JSON.parse(JSON.stringify(t)),this.modal.show()},closeModal(){this.modal.hide()},createImages(){this.product.imagesUrl=[],this.product.imagesUrl.push("")},uploadImage(){this.loader=this.$loading.show(),this.uploadStatus=!0;const e=this.$refs.uploadInput.files[0],t=new FormData;t.append("file-to-upload",e);const s="\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/upload\n      ";this.$http.post(s,t,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{e.data.success?(this.product.imageUrl=e.data.imageUrl,this.$refs.uploadInput.value="",this.emitter.emit("push-message",{style:"success",title:"上傳圖片",content:"圖片上傳成功!"}),this.uploadStatus=!1,this.loader.hide()):(this.$refs.uploadInput.value="",this.emitter.emit("push-message",{style:"danger",title:"上傳圖片",content:e.data.message}),this.uploadStatus=!1,this.loader.hide())})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"上傳圖片",content:e.response.data.message}),this.uploadStatus=!1,this.loader.hide()}))}},mounted(){this.modal=new(je())(this.$refs.productModal,{backdrop:"static",keyboard:!1})}},Se=s(89);const Ne=(0,Se.Z)(ze,[["render",Ve]]);var Ge=Ne,Re=s(7839),We={data(){return{products:[],pagination:{},selectedItemId:"",loader:{}}},components:{PaginationComp:M.Z,ProductModal:Ge,DeleteModal:Re.Z},inject:["emitter"],methods:{getProducts(e=1){this.loader=this.$loading.show();const t=`\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/products/?page=${e}\n      `;this.$http.get(t).then((e=>{const{products:t,pagination:s}=e.data;this.products=t,this.pagination=s,this.loader.hide()})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"取得產品",content:e.response.data.message}),this.loader.hide()}))},postProduct(e){const t="\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/product\n      ";this.$http.post(t,{data:e}).then((t=>{this.$refs.modal.closeModal(),this.getProducts(),this.emitter.emit("push-message",{style:"success",title:"新增產品",content:`${t.data.message}：${e.title}`})})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"新增產品",content:e.response.data.message})}))},putProduct(e,t){this.selectedItemId=e;const s=`\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/product/${e}\n      `;this.$http.put(s,{data:t}).then((e=>{this.$refs.modal.closeModal(),this.getProducts(this.pagination.current_page),this.emitter.emit("push-message",{style:"primary",title:"更新產品",content:`${e.data.message}：${t.title}`}),this.selectedItemId=""})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"更新產品",content:e.response.data.message}),this.selectedItemId=""}))},deleteProduct(e){this.selectedItemId=e;const t=`\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/product/${e}\n      `;this.$http.delete(t).then((e=>{this.getProducts(),this.emitter.emit("push-message",{style:"danger",title:"刪除產品",content:e.data.message}),this.selectedItemId="",this.$refs.deleteModal.closeModal()})).catch((e=>{this.emitter.emit("push-message",{style:"danger",title:"刪除產品",content:e.response.data.message}),this.selectedItemId="",this.$refs.deleteModal.closeModal()}))}},mounted(){this.getProducts()}};const Ze=(0,Se.Z)(We,[["render",D]]);var He=Ze}}]);
//# sourceMappingURL=682.c866f0de.js.map