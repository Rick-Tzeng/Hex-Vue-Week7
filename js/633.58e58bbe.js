"use strict";(self["webpackChunkhomework02"]=self["webpackChunkhomework02"]||[]).push([[633],{2633:function(t,e,l){l.r(e),l.d(e,{default:function(){return bt}});var a=l(3396),s=l(7139);const i={class:"d-flex justify-content-between align-items-center"},o=(0,a._)("h1",{class:"my-3"},"貼文列表",-1),c={class:"table table-striped table-hover align-middle text-center"},r=(0,a._)("thead",{class:"bg-dark text-white"},[(0,a._)("tr",null,[(0,a._)("th",null,"編號"),(0,a._)("th",null,"標題"),(0,a._)("th",null,"作者"),(0,a._)("th",null,"貼文描述"),(0,a._)("th",null,"建立日期"),(0,a._)("th",null,"是否公開"),(0,a._)("th",null,"編輯內容")])],-1),n={class:"fw-bold"},d=(0,a._)("span",{class:"fw-bold"},"公開狀態：",-1),p={key:0,class:"text-success fw-bold"},u={key:1,class:"text-muted"},m={class:"btn-group btn-group-sm"},h=["onClick","disabled"],b=["onClick","disabled"],g={class:"py-5"};function _(t,e,l,_,y,f){const w=(0,a.up)("PaginationComp"),v=(0,a.up)("ArticleModal"),k=(0,a.up)("DeleteModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",i,[o,(0,a._)("div",null,[(0,a._)("button",{class:"btn btn-success",type:"button",onClick:e[0]||(e[0]=t=>this.$refs.modal.openModal(!0,{}))}," 新增貼文 ")])]),(0,a._)("table",c,[r,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(y.articles,((t,e)=>((0,a.wg)(),(0,a.iD)("tr",{key:"a"+e},[(0,a._)("td",n,(0,s.zw)(e+1),1),(0,a._)("td",null,(0,s.zw)(t.title),1),(0,a._)("td",null,(0,s.zw)(t.author),1),(0,a._)("td",null,(0,s.zw)(t.description),1),(0,a._)("td",null,(0,s.zw)(new Date(1e3*t.create_at).toLocaleDateString()),1),(0,a._)("td",null,[d,t.isPublic?((0,a.wg)(),(0,a.iD)("span",p," 已公開 ")):((0,a.wg)(),(0,a.iD)("span",u," 未公開 "))]),(0,a._)("td",null,[(0,a._)("div",m,[(0,a._)("button",{class:"btn btn-outline-primary",type:"button",onClick:e=>f.getArticle(t.id),disabled:y.selectedItemId===t.id}," 修改 ",8,h),(0,a._)("button",{class:"btn btn-outline-danger",type:"button",onClick:e=>this.$refs.deleteModal.openModal(t),disabled:y.selectedItemId===t.id}," 刪除 ",8,b)])])])))),128))])]),(0,a._)("div",g,[(0,a.Wm)(w,{pagination:y.pagination,onGetRequest:f.getArticles},null,8,["pagination","onGetRequest"])]),(0,a.Wm)(v,{ref:"modal",onPostArticle:f.postArticle,onPutArticle:f.putArticle},null,8,["onPostArticle","onPutArticle"]),(0,a.Wm)(k,{ref:"deleteModal",onDelItem:f.deleteArticle},null,8,["onDelItem"])],64)}var y=l(9242);const f={class:"modal fade",ref:"articleModal",tabindex:"-1"},w={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"},v={class:"modal-content border-0"},k={key:0},A=(0,a._)("div",{class:"modal-header bg-success"},[(0,a._)("h5",{class:"modal-title text-white"}," 新增貼文 "),(0,a._)("button",{type:"button",class:"btn-close bg-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D=[A],x={key:1},M=(0,a._)("div",{class:"modal-header bg-primary"},[(0,a._)("h5",{class:"modal-title text-white"}," 編輯貼文 "),(0,a._)("button",{type:"button",class:"btn-close bg-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),$=[M],C={class:"modal-body"},U={class:"mb-3"},P=(0,a._)("label",{class:"form-label",for:"article-title"},"貼文標題",-1),I={class:"mb-3"},V=(0,a._)("label",{class:"form-label",for:"article-image"},"貼文圖片",-1),j={class:"mb-3"},q=(0,a._)("label",{class:"form-label",for:"article-author"},"作者",-1),N={class:"mb-3"},z=(0,a._)("label",{class:"form-label",for:"article-post_date"},"貼文建立日期",-1),S={class:"mb-3"},T={key:0},Z={class:"mb-3"},H=(0,a._)("label",{class:"form-label",for:"article-tag"},"新增標籤",-1),O=["onUpdate:modelValue"],W={key:0},Y={key:1},G={key:1},J={class:"mb-3"},K=(0,a._)("label",{class:"form-label",for:"article-description"},"貼文描述",-1),R={class:"mb-3"},L=(0,a._)("label",{class:"form-label",for:"article-content"},"貼文內容",-1),B={class:"mb-3"},E={class:"form-check form-switch"},F=(0,a._)("span",{class:"fw-bold"},"公開狀態：",-1),Q={key:0,class:"form-check-label text-success fw-bold",for:"is-public"},X={key:1,class:"form-check-label text-muted",for:"is-public"},tt={class:"modal-footer"},et={key:0},lt={key:1},at=(0,a._)("button",{class:"btn btn-secondary",type:"button","data-bs-dismiss":"modal"}," 取消 ",-1);function st(t,e,l,s,i,o){return(0,a.wg)(),(0,a.iD)("div",f,[(0,a._)("div",w,[(0,a._)("div",v,[i.isNewArticle?((0,a.wg)(),(0,a.iD)("div",k,D)):((0,a.wg)(),(0,a.iD)("div",x,$)),(0,a._)("div",C,[(0,a._)("div",U,[P,(0,a.wy)((0,a._)("input",{class:"form-control",type:"text",id:"article-title","onUpdate:modelValue":e[0]||(e[0]=t=>i.article.title=t),placeholder:"請輸入貼文標題",required:""},null,512),[[y.nr,i.article.title]])]),(0,a._)("div",I,[V,(0,a.wy)((0,a._)("input",{class:"form-control",type:"text",id:"article-image","onUpdate:modelValue":e[1]||(e[1]=t=>i.article.imageUrl=t),placeholder:"請輸入圖片網址",required:""},null,512),[[y.nr,i.article.imageUrl]])]),(0,a._)("div",j,[q,(0,a.wy)((0,a._)("input",{class:"form-control",type:"text",id:"article-author","onUpdate:modelValue":e[2]||(e[2]=t=>i.article.author=t),placeholder:"請輸入作者名稱",required:""},null,512),[[y.nr,i.article.author]])]),(0,a._)("div",N,[z,(0,a.wy)((0,a._)("input",{class:"form-control",type:"date",id:"article-post_date","onUpdate:modelValue":e[3]||(e[3]=t=>i.post_date=t),required:""},null,512),[[y.nr,i.post_date]])]),(0,a._)("div",S,[Array.isArray(i.article.tag)?((0,a.wg)(),(0,a.iD)("div",T,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.article.tag,((t,e)=>((0,a.wg)(),(0,a.iD)("div",{class:"mb-1",key:"tag"+e},[(0,a._)("div",Z,[H,(0,a.wy)((0,a._)("input",{class:"form-control",type:"text",id:"article-tag","onUpdate:modelValue":t=>i.article.tag[e]=t,placeholder:"請輸入標籤"},null,8,O),[[y.nr,i.article.tag[e]]])])])))),128)),!i.article.tag.length||i.article.tag[i.article.tag.length-1]?((0,a.wg)(),(0,a.iD)("div",W,[(0,a._)("button",{class:"btn btn-outline-primary",onClick:e[4]||(e[4]=t=>i.article.tag.push(""))}," 新增標籤 ")])):((0,a.wg)(),(0,a.iD)("div",Y,[(0,a._)("button",{class:"btn btn-outline-danger",onClick:e[5]||(e[5]=t=>i.article.tag.pop(""))}," 刪除標籤 ")]))])):((0,a.wg)(),(0,a.iD)("div",G,[(0,a._)("button",{class:"btn btn-outline-primary",onClick:e[6]||(e[6]=(...t)=>o.createTags&&o.createTags(...t))}," 新增標籤 ")]))]),(0,a._)("div",J,[K,(0,a.wy)((0,a._)("textarea",{class:"form-control",type:"text",id:"article-description","onUpdate:modelValue":e[7]||(e[7]=t=>i.article.description=t),placeholder:"請輸入貼文描述"},null,512),[[y.nr,i.article.description]])]),(0,a._)("div",R,[L,(0,a.wy)((0,a._)("textarea",{class:"form-control",type:"text",id:"article-content","onUpdate:modelValue":e[8]||(e[8]=t=>i.article.content=t),placeholder:"請輸入貼文描述"},null,512),[[y.nr,i.article.content]])]),(0,a._)("div",B,[(0,a._)("div",E,[F,(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:"is-public","onUpdate:modelValue":e[9]||(e[9]=t=>i.article.isPublic=t),required:""},null,512),[[y.e8,i.article.isPublic]]),i.article.isPublic?((0,a.wg)(),(0,a.iD)("label",Q," 已公開 ")):((0,a.wg)(),(0,a.iD)("label",X," 未公開 "))])])]),(0,a._)("div",tt,[i.isNewArticle?((0,a.wg)(),(0,a.iD)("div",et,[(0,a._)("button",{class:"btn btn-success",type:"button",onClick:e[10]||(e[10]=e=>t.$emit("post-article",i.article))}," 確認新增 ")])):((0,a.wg)(),(0,a.iD)("div",lt,[(0,a._)("button",{class:"btn btn-primary",type:"button",onClick:e[11]||(e[11]=e=>t.$emit("put-article",i.article.id,i.article))}," 確認編輯 ")])),at])])])],512)}var it=l(7972),ot=l.n(it),ct={data(){return{modal:{},article:{tag:[]},post_date:"",isNewArticle:!1}},methods:{openModal(t,e){if(this.isNewArticle=t,t)this.article={},this.post_date="";else{this.article=JSON.parse(JSON.stringify(e));const t=new Date(1e3*this.article.create_at).toISOString().split("T");[this.post_date]=t}this.modal.show()},closeModal(){this.modal.hide()},createTags(){this.article.tag=[],this.article.tag.push("")}},watch:{post_date(){this.article.create_at=Math.floor(new Date(this.post_date)/1e3)}},mounted(){this.modal=new(ot())(this.$refs.articleModal,{backdrop:"static",keyboard:!1})}},rt=l(89);const nt=(0,rt.Z)(ct,[["render",st]]);var dt=nt,pt=l(4174),ut=l(7839),mt={data(){return{articles:[],pagination:{},selectedItemId:"",loader:{}}},components:{ArticleModal:dt,PaginationComp:pt.Z,DeleteModal:ut.Z},inject:["emitter"],methods:{getArticles(t=1){this.loader=this.$loading.show();const e=`\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/articles/?page=${t}\n      `;this.$http.get(e).then((t=>{const{articles:e,pagination:l}=t.data;this.articles=e,this.pagination=l,this.loader.hide()})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:"取得貼文",content:t.response.data.message}),this.loader.hide()}))},getArticle(t){const e=`\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/article/${t}\n      `;this.$http.get(e).then((t=>{const{article:e}=t.data;this.$refs.modal.openModal(!1,e)})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:"取得單篇貼文",content:t.response.data.message})}))},postArticle(t){const e="\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/article\n      ";this.$http.post(e,{data:t}).then((t=>{this.$refs.modal.closeModal(),this.getArticles(),this.emitter.emit("push-message",{style:"success",title:"新增貼文",content:t.data.message})})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:"新增貼文",content:t.response.data.message})}))},putArticle(t,e){const l=`\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/article/${t}\n      `;this.$http.put(l,{data:e}).then((t=>{this.$refs.modal.closeModal(),this.getArticles(),this.emitter.emit("push-message",{style:"success",title:"更新貼文",content:t.data.message})})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:"更新貼文",content:t.response.data.message})}))},deleteArticle(t){const e=`\n        https://vue3-course-api.hexschool.io/v2/api/rick917jp6-api/admin/article/${t}\n      `;this.$http.delete(e).then((t=>{console.log(t),this.$refs.deleteModal.closeModal(),this.getArticles(),this.emitter.emit("push-message",{style:"danger",title:"刪除貼文",content:t.data.message})})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:"刪除貼文",content:t.response.data.message}),this.$refs.deleteModal.closeModal()}))}},mounted(){this.getArticles()}};const ht=(0,rt.Z)(mt,[["render",_]]);var bt=ht}}]);
//# sourceMappingURL=633.58e58bbe.js.map